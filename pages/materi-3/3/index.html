<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/circle.png" type="image/x-icon">
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#00897B"/>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <!-- Main CSS -->
    <link rel="stylesheet" href="/assets/css/course.css">

    <title>Kuis - Lingkaran</title>
    <style>
      .slide {
        position: absolute;
        left: 0px;
        top: 0px;
        width: 100%;
        z-index: 1;
        opacity: 0;
        transition: opacity 0.1s;
      }

      .active-slide {
        opacity: 1;
        z-index: 2;
      }

      .card {
        position: relative;
      }

      .quiz-container {
        position: relative;
        height: 350px;
        margin-top: 10px;
      }

      .question {
        font-size: 16px;
        margin-bottom: 10px;
      }

      .answers {
        margin-bottom: 20px;
        text-align: left;
        display: inline-block;
      }

      .answers label {
        display: block;
        margin-bottom: 10px;
      }

      @media only screen and(max-width: 720px) {
        .quiz-container {
          height: 700px;
        }
      }

      @media only screen and(max-width: 480px) {
        .quiz-container {
          height: 700px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light" id="nav">
      
    </nav>

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="breadcrumb-header">
      <ol class="breadcrumb container">
        <li class="breadcrumb-item"><a href="/">Beranda</a></li>
        <li class="breadcrumb-item"><a href="/pages/materi-3/0/">Luas Lingkaran</a></li>
        <li class="breadcrumb-item active">Kuis</li>
      </ol>
    </nav>
    <!-- End Breadcrumb -->

    <!-- Main Content -->
    <div class="container my-4">
      <div class="row">
        <div class="col-lg-3 col-sm-12">
          <div class="list-course">

          </div>
        </div>
        
        <div class="col-lg-9 col-sm-12">
          <div class="card card-body">
            <!-- Start Course -->
            <h1>Kuis</h1>
            <div class="card my-3">
              <div class="card-body course">
                <h6>Petunjuk</h6>
                <ul style="font-size: 13px">
                  <li>Pilihlah dengan jawaban yang benar.</li>
                  <li>Tekan tombol <span class="btn btn-sm btn-success">Selanjutnya</span> untuk berpindah kesoal selanjutnya.</li>
                  <li>Tekan tombol <span class="btn btn-sm btn-secondary">Sebelumnya</span> untuk berpindah kesoal sebelumnya.</li>
                  <li>Tekan tombol <span class="btn btn-sm btn-danger">Selesai</span> untuk mengakhiri menjawab soal, halaman akan menampilkan nilai.</li>
                </ul>
              </div>
            </div>
            
            <div class="card-body">
              <!-- Container soal -->
              
              <div class="quiz-container">
                <div id="quiz"></div>
              </div>
              <hr>
              <div class="btn-action text-center">
                <button id="back" class="btn btn-md btn-secondary shadow">Sebelumnya</button>
                <button id="next" class="btn btn-md btn-success shadow" >Selanjutnya</button>
                <button id="submit" class="btn btn-md btn-danger end shadow">Selesai</button>
              </div>
              <!-- End Container Soal -->
            </div>
            
          </div>
        </div>
      </div>
    </div>
    <!-- End Content -->

    <!-- Footer -->
    <section id="footer">
        
    </section>

    <!-- JS Component -->
    <script src="/components/navbar.js"></script>
    <script src="/components/list-course.js"></script>
    <script src="/components/footer.js"></script>
    <!-- Mathjax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <!-- Bootstrap JS -->
    <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/pages/materi-3/3/soal.js"></script>
    <script>
      let randomQuestion = questions.sort((a, b) => {return 0.5 - Math.random()});

      function buildQuiz() {
        const output = []
        let currentNumber = 1

        randomQuestion.forEach((currentQuestion, questionNumber) => {
          const answers = []

          for(letter in currentQuestion.answers) {
              answers.push(
                  `
                    <label>
                      <input type="radio" name="question${questionNumber}" value="${letter}" data="${currentNumber}" class="answer">
                      <span>${letter}. ${currentQuestion.answers[letter]}<span>
                    </label>
                  `
              )
          }

          output.push(
              `
                <div class="slide">
                  <div class="question">${currentNumber}. ${currentQuestion.question}</div>
                  <div class="answers">${answers.join("")}</div>
                </div>
              `
          )
          
          currentNumber++
        })
        questionContainer.innerHTML = output.join("")
        
      }


      function showSlide(n) {
        slides[currentSlide].classList.remove('active-slide')
        slides[n].classList.add('active-slide')
        currentSlide = n

        if(currentSlide === 0) {
          backButton.style.display = "none"
        } else {
          backButton.style.display = "inline-block"
        }

        if(currentSlide === slides.length - 1) {
          nextButton.style.display = "none"
          submitButton.style.display = "inline-block"
        } else {
          nextButton.style.display = "inline-block"
          submitButton.style.display = "none"
        }
      }

      function nextSlide() {
        showSlide(currentSlide + 1)
      }

      function backSlide() {
        showSlide(currentSlide - 1)
      }

      function paginationSlide(n) {
        showSlide(n)
      }

      let questionContainer = document.querySelector("#quiz")
      let nextButton = document.querySelector("#next") 
      let backButton = document.querySelector("#back") 
      let submitButton = document.querySelector("#submit")

      buildQuiz()

      const slides = document.querySelectorAll(".slide")
      let currentSlide = 0

      showSlide(currentSlide)
      nextButton.addEventListener("click", nextSlide)
      backButton.addEventListener("click", backSlide)
      submitButton.addEventListener("click", result)

      function result() {
        const answerContainers = questionContainer.querySelectorAll(".answers");

        let correct = 0;
        let wrong = 0;

        randomQuestion.forEach((currentQuestion, questionNumber) => {
          const answerContainer = answerContainers[questionNumber];

          const selector = `input[name=question${questionNumber}]:checked`;
          const userAnswer = (answerContainer.querySelector(selector) || {}).value;

          if (userAnswer === currentQuestion.correctAnswer) {
            correct++;
          } else {
            wrong++;
          }

          sessionStorage.setItem('length', randomQuestion.length);
          sessionStorage.setItem('wrong', wrong);
          sessionStorage.setItem('correct', correct);
          location.href = './result.html';
        });
      }

    </script>
  </body>
</html>